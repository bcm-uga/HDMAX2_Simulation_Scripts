# HDMAX2_Simulation_Scripts
Scripts reproducing simulation analyses presented in the study "High Dimensional Mediation Analysis: a new method applied to maternal smoking, placental DNA methylation and birth outcomes" by Jumentier et al. 2022. medRxiv doi: https://doi.org/10.1101/2022.03.15.22272404 


The **Simulation** folder contains three R scripts 

- launch_simulations_figure_S4.R: Simulation study that compares the hdmax2 approach to classical mediation and Sobel tests. The script reproduces Figure S4.

- launch_simulations_Figure_2.R: Simulation study that compares latent factor models in step 1 of the HDMA and currently used methods that incorporate a priori estimates of cell type composition (RefFreeEWAS et refactor). The script reproduces Figure 2.

- launch_simulations_Figure_3.R: Simulation study that compares hdmax2 to recent approaches for HDMA in step 2 of the mediation analysis. The script reproduces Figure 3.

The **Overview** folder contains a short Rmarkdown tutorial on how to use the R package hdmax2



